<app-navbar></app-navbar>

<div class="ambulance-page min-vh-100 position-relative overflow-hidden text-light">
  <div class="ambulance-bg"></div>

  <div class="container position-relative z-3 py-5">
    <div class="row justify-content-center">
      <div class="col-lg-8">
        <div class="ambulance-card">
          <h2 class="fw-bold text-center mb-4 text-white">Request Ambulance</h2>

          <!-- Success Message -->
          <div *ngIf="successMessage" class="alert alert-success text-center mb-4">
            {{ successMessage }}
          </div>

          <form [formGroup]="ambulanceForm" (ngSubmit)="onSubmit()">
            <div class="row g-3">
              <!-- Full Name -->
              <div class="col-md-12">
                <input type="text" class="form-control" placeholder="Full Name *" formControlName="fullName"
                  [class.is-invalid]="submitted && f['fullName'].errors" />
                <div *ngIf="submitted && f['fullName'].errors" class="invalid-feedback">
                  Full Name is required.
                </div>
              </div>

              <!-- Phone -->
              <div class="col-md-6">
                <input type="tel" class="form-control" placeholder="Phone / WhatsApp *" formControlName="phone"
                  [class.is-invalid]="submitted && f['phone'].errors" />
                <div *ngIf="submitted && f['phone'].errors" class="invalid-feedback">
                  Valid phone number required.
                </div>
              </div>

              <!-- Location -->
              <div class="col-md-6">
                <input type="text" class="form-control" placeholder="Pickup Location / Address *" formControlName="location"
                  [class.is-invalid]="submitted && f['location'].errors" />
                <div *ngIf="submitted && f['location'].errors" class="invalid-feedback">
                  Location is required.
                </div>
              </div>

              <!-- Service Type -->
              <div class="col-12">
                <select class="form-control" formControlName="type"
                  [class.is-invalid]="submitted && f['type'].errors" style="background-color: rgb(90, 90, 174);">
                  <option value="" disabled selected>Select Service Type *</option>
                  <option value="emergency">Emergency Transport</option>
                  <option value="transfer">Hospital Transfer</option>
                  <option value="event">Event Standby</option>
                </select>
                <div *ngIf="submitted && f['type'].errors" class="invalid-feedback">
                  Please select a service type.
                </div>
              </div>

              <!-- Description -->
              <div class="col-12">
                <textarea class="form-control" rows="4" placeholder="Description of Emergency / Request *" formControlName="description"
                  [class.is-invalid]="submitted && f['description'].errors"></textarea>
                <div *ngIf="submitted && f['description'].errors" class="invalid-feedback">
                  Description is required.
                </div>
              </div>

              <!-- Payment Method -->
              <h5 class="mb-3 mt-4">Payment Method</h5>
              <div class="col-12">
                <div class="form-check">
                  <input class="form-check-input" type="radio" formControlName="paymentMethod" value="bank-transfer" id="bank-transfer"
                    (change)="onPaymentChange('bank-transfer')">
                  <label class="form-check-label" for="bank-transfer">Bank Transfer</label>
                </div>
                <div class="form-check">
                  <input class="form-check-input" type="radio" formControlName="paymentMethod" value="paystack" id="paystack"
                    (change)="onPaymentChange('paystack')">
                  <label class="form-check-label" for="paystack">Paystack / Flutterwave</label>
                </div>
                <div *ngIf="submitted && f['paymentMethod'].errors" class="invalid-feedback">
                  Please select a payment method.
                </div>

                <!-- Bank Details (Only for Bank Transfer) -->
                <div *ngIf="paymentMethod === 'bank-transfer'" class="mt-3 p-3 border rounded bg-dark">
                  <h6>Bank Details</h6>
                  <p class="mb-2">Bank: GTBank<br>
                     Account Name: 911Medic Ltd<br>
                     Account Number: 0123456789</p>
                  <label class="form-label">Upload Payment Receipt (Optional)</label>
                  <input type="file" class="form-control" (change)="onReceiptUpload($event)" accept="image/*,.pdf" />
                </div>
              </div>

              <!-- Submit Button -->
              <div class="text-center mt-5">
                <button type="submit" class="btn btn-danger btn-lg px-5 py-3"
                  [disabled]="ambulanceForm.invalid || isLoading">
                  <span *ngIf="isLoading" class="spinner-border spinner-border-sm me-2" role="status"></span>
                  {{ isLoading ? 'Processing...' : 'Request Ambulance' }}
                </button>
              </div>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>

<app-footer></app-footer>